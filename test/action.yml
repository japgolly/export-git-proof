name: 'export-git-proof-test'
description: 'Tests'

# ======================================================================================================================
inputs:

  gist_id:
    description: "id of the gist"
    required: true

# ======================================================================================================================
runs:
  using: 'composite'
  steps:

    - name: Get git log
      shell: bash
      run: |
        echo "LOG_OUTPUT<<EOF" >> $GITHUB_ENV
        git log --stat >> $GITHUB_ENV
        echo "EOF" >> $GITHUB_ENV

    - name: Read gist
      id: read_gist
      uses: gorgbus/gist-actions@main
      with:
        action: get
        gist_id: ${{ inputs.gist_id }}
        file_name: log.txt

    - name: Compare outputs
      shell: bash
      run: |
        if [ "${{ env.LOG_OUTPUT }}" != "${{ steps.read_gist.outputs.content }}" ]; then
          echo "Gist contents not as expected:"
          echo "Expect: '${{ env.LOG_OUTPUT }}'"
          echo "Actual: '${{ steps.read_gist.outputs.content }}'"
          exit 1
        else
          echo "Confirmed: gist updated successfully."
        fi
